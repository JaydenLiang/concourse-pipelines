resources:
  - name: pipeline-repo
    type: git
    source:
      uri: https://github.com/JaydenLiang/concourse-pipelines.git
      branch: develop
  - name: azure-rest-api
    type: docker-image
    source:
      - repository: registry.docker.fornow.app/v2/azure-rest-api
      - username: jaydenliang
      - password: Jayden*Liang

jobs:
  - name: demo
    public: true
    plan:
      - get: pipeline-repo
      - get: azure-rest-api
      - task: fetch-demo-inputs
        file: pipeline-repo/resources/demo-inputs.yml
      - task: create-demo-outputs
        config:
          platform: linux
          image_resource:
            type: docker-image
            source: { repository: busybox }
          inputs:
            - name: pipeline-repo
          outputs:
            - name: demo_outputs
          run:
            path: pipeline-repo/scripts/demo_outputs.sh
      - task: show-demo-outputs
        config:
          platform: linux
          image_resource:
            type: docker-image
            source: { repository: busybox }
          inputs:
            - name: pipeline-repo
            - name: demo_outputs
          run:
            path: cat
            args: [demo_outputs/default]
